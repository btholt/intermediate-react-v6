<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/x-icon" href="/images/favicon.ico" data-next-head=""/><title data-next-head="">The Project – Intermediate React v6</title><meta name="description" content="Discover how to build a UI in React using server and client interactions including POST requests with intentional delays for error simulation, as outlined in Brian Holt&#x27;s Intermediate React v6 course on Frontend Masters. Learn to handle UI feedback during asynchronous operations efficiently with techniques like useOptimisticState, enhancing your web development skills with JavaScript and server components." data-next-head=""/><meta name="keywords" content="React,server components,UI development,Brian Holt,Frontend Masters,JavaScript,web development" data-next-head=""/><meta name="og:description" content="Discover how to build a UI in React using server and client interactions including POST requests with intentional delays for error simulation, as outlined in Brian Holt&#x27;s Intermediate React v6 course on Frontend Masters. Learn to handle UI feedback during asynchronous operations efficiently with techniques like useOptimisticState, enhancing your web development skills with JavaScript and server components." data-next-head=""/><meta name="og:title" content="The Project – Intermediate React v6" data-next-head=""/><meta name="og:image" content="/images/social-share-cover.jpg" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/0732dfa8741dc542.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0732dfa8741dc542.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-b66ed8ba6f029a99.js" defer=""></script><script src="/_next/static/chunks/framework-a4ddb9b21624b39b.js" defer=""></script><script src="/_next/static/chunks/main-d4c20200ddabac7f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-31cd0638bbee6098.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-7da2347a1e0b6c73.js" defer=""></script><script src="/_next/static/81bftuYLGkwiC8AXLtnRs/_buildManifest.js" defer=""></script><script src="/_next/static/81bftuYLGkwiC8AXLtnRs/_ssgManifest.js" defer=""></script></head><body><script async="" defer="" src="https://a.holt.courses/latest.js"></script><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Intermediate React v6</a></h1><div class="navbar-info"><a href="https://frontendmasters.com/courses/intermediate-react-v6/" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><blockquote>
<p>You will need to open the folder <code>optimistic</code> from the repo in your project.</p>
<ul>
<li><a href="https://github.com/btholt/irv6-project/tree/main/starter/optimistic">The starter template</a></li>
<li><a href="https://github.com/btholt/irv6-project/tree/main/completed/optimistic">The completed project</a></li>
</ul>
</blockquote>
<p>Let&#39;s open the project.</p>
<ol>
<li>Open optimistic folder in your editor of choice</li>
<li>Run <code>npm install</code></li>
<li>Glance at server.js - it responds to GET and POST on /thoughts</li>
<li>Run <code>npm run dev:server</code> to run the server</li>
<li>Run <code>npm run dev:client</code> in another terminal window to run the Vite server</li>
</ol>
<p>You&#39;ll notice two things here in the server.js file, the DELAY and the ERROR_RATE. I intentionally slowed down the POST request so you can see how the loading state works. Feel free to change how long the delay is (it&#39;s in milliseconds). I also wanted you to see what errors look like, so it fails 20% of the time, this is also configurable.</p>
<p>Okay, let&#39;s build a UI that shows users deep thoughts, and allow them to post their own. In App.jsx, put</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> { useEffect, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> [thoughts, setThoughts] = <span class="hljs-title function_">useState</span>([]);
  <span class="hljs-keyword">const</span> [thought, setThought] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&quot;&quot;</span>);

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">postDeepThought</span>(<span class="hljs-params"></span>) {
    <span class="hljs-title function_">setThought</span>(<span class="hljs-string">&quot;&quot;</span>);
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/thoughts&quot;</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ thought }),
    });
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;This thought was not deep enough. Please try again.&quot;</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">const</span> { <span class="hljs-attr">thoughts</span>: newThoughts } = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    <span class="hljs-title function_">setThoughts</span>(newThoughts);
  }

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/thoughts&quot;</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>())
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        <span class="hljs-title function_">setThoughts</span>(data);
      });
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Deep Thoughts<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">form</span>
        <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{(e)</span> =&gt;</span> {
          e.preventDefault();
          postDeepThought();
        }}
      &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">&quot;thought&quot;</span>&gt;</span>What&#x27;s on your mind?<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;thought&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;thought&quot;</span>
          <span class="hljs-attr">rows</span>=<span class="hljs-string">&quot;5&quot;</span>
          <span class="hljs-attr">cols</span>=<span class="hljs-string">&quot;33&quot;</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{thought}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setThought(e.target.value)}
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {thoughts.map((thought, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{thought}</span>&gt;</span>{thought}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre><ul>
<li>Nothing surprising here. We get thoughts on load, and we reload them on POST</li>
<li>The big issue here is that the user is shown no feedback while the POST happening.</li>
<li>We could just append to thoughts and hope for the best - and this is what we used to do.</li>
<li>However we can use <code>useOptimistic</code> and get a lot of the error cases and other problems wrapped up and taken care of for us.</li>
</ul>
</div><div class="lesson-links"><a href="/lessons/optimistic-values/what-are-optimistic-values" class="prev">← Previous</a><a href="/lessons/optimistic-values/useOptimistic-Hook" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg fill="none" height="auto" width="32" xmlns="http://www.w3.org/2000/svg" viewBox="0.254 0.25 500 451.95400000000006"><path d="M394.033.25h76.67L303.202 191.693l197.052 260.511h-154.29L225.118 294.205 86.844 452.204H10.127l179.16-204.77L.254.25H158.46l109.234 144.417zm-26.908 406.063h42.483L135.377 43.73h-45.59z" fill="var(--footer-icons)"></path></svg></a></li><li class="social"><a href="https://bsky.app/profile/brianholt.me"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -3.268 64 68.414" width="38" height="auto"><path fill="var(--footer-icons)" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805zm36.254 0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"></path></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Exercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"description":"Discover how to build a UI in React using server and client interactions including POST requests with intentional delays for error simulation, as outlined in Brian Holt's Intermediate React v6 course on Frontend Masters. Learn to handle UI feedback during asynchronous operations efficiently with techniques like useOptimisticState, enhancing your web development skills with JavaScript and server components.","keywords":["React","server components","UI development","Brian Holt","Frontend Masters","JavaScript","web development"]},"html":"\u003cblockquote\u003e\n\u003cp\u003eYou will need to open the folder \u003ccode\u003eoptimistic\u003c/code\u003e from the repo in your project.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/btholt/irv6-project/tree/main/starter/optimistic\"\u003eThe starter template\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/btholt/irv6-project/tree/main/completed/optimistic\"\u003eThe completed project\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eLet\u0026#39;s open the project.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eOpen optimistic folder in your editor of choice\u003c/li\u003e\n\u003cli\u003eRun \u003ccode\u003enpm install\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eGlance at server.js - it responds to GET and POST on /thoughts\u003c/li\u003e\n\u003cli\u003eRun \u003ccode\u003enpm run dev:server\u003c/code\u003e to run the server\u003c/li\u003e\n\u003cli\u003eRun \u003ccode\u003enpm run dev:client\u003c/code\u003e in another terminal window to run the Vite server\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eYou\u0026#39;ll notice two things here in the server.js file, the DELAY and the ERROR_RATE. I intentionally slowed down the POST request so you can see how the loading state works. Feel free to change how long the delay is (it\u0026#39;s in milliseconds). I also wanted you to see what errors look like, so it fails 20% of the time, this is also configurable.\u003c/p\u003e\n\u003cp\u003eOkay, let\u0026#39;s build a UI that shows users deep thoughts, and allow them to post their own. In App.jsx, put\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { useEffect, useState } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eApp\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e [thoughts, setThoughts] = \u003cspan class=\"hljs-title function_\"\u003euseState\u003c/span\u003e([]);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e [thought, setThought] = \u003cspan class=\"hljs-title function_\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003epostDeepThought\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-title function_\"\u003esetThought\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e response = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/thoughts\u0026quot;\u003c/span\u003e, {\n      \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e,\n      \u003cspan class=\"hljs-attr\"\u003eheaders\u003c/span\u003e: {\n        \u003cspan class=\"hljs-string\"\u003e\u0026quot;Content-Type\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e,\n      },\n      \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e({ thought }),\n    });\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!response.\u003cspan class=\"hljs-property\"\u003eok\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_\"\u003ealert\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;This thought was not deep enough. Please try again.\u0026quot;\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n    }\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-attr\"\u003ethoughts\u003c/span\u003e: newThoughts } = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e();\n    \u003cspan class=\"hljs-title function_\"\u003esetThoughts\u003c/span\u003e(newThoughts);\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/thoughts\u0026quot;\u003c/span\u003e)\n      .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eres\u003c/span\u003e) =\u0026gt;\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e())\n      .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_\"\u003esetThoughts\u003c/span\u003e(data);\n      });\n  }, []);\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;app\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eh1\u003c/span\u003e\u0026gt;\u003c/span\u003eDeep Thoughts\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eh1\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eform\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eonSubmit\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{(e)\u003c/span\u003e =\u0026gt;\u003c/span\u003e {\n          e.preventDefault();\n          postDeepThought();\n        }}\n      \u0026gt;\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003elabel\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehtmlFor\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;thought\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eWhat\u0026#x27;s on your mind?\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003elabel\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etextarea\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;thought\u0026quot;\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;thought\u0026quot;\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003erows\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;5\u0026quot;\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003ecols\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;33\u0026quot;\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{thought}\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003eonChange\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{(e)\u003c/span\u003e =\u0026gt;\u003c/span\u003e setThought(e.target.value)}\n        /\u0026gt;\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eSubmit\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eform\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eul\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        {thoughts.map((thought, index) =\u0026gt; (\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{thought}\u003c/span\u003e\u0026gt;\u003c/span\u003e{thought}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eli\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        ))}\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eul\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  );\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eNothing surprising here. We get thoughts on load, and we reload them on POST\u003c/li\u003e\n\u003cli\u003eThe big issue here is that the user is shown no feedback while the POST happening.\u003c/li\u003e\n\u003cli\u003eWe could just append to thoughts and hope for the best - and this is what we used to do.\u003c/li\u003e\n\u003cli\u003eHowever we can use \u003ccode\u003euseOptimistic\u003c/code\u003e and get a lot of the error cases and other problems wrapped up and taken care of for us.\u003c/li\u003e\n\u003c/ul\u003e\n","markdown":"\n\u003e You will need to open the folder `optimistic` from the repo in your project.\n\u003e\n\u003e - [The starter template][starter]\n\u003e - [The completed project][completed]\n\nLet's open the project.\n\n1. Open optimistic folder in your editor of choice\n1. Run `npm install`\n1. Glance at server.js - it responds to GET and POST on /thoughts\n1. Run `npm run dev:server` to run the server\n1. Run `npm run dev:client` in another terminal window to run the Vite server\n\nYou'll notice two things here in the server.js file, the DELAY and the ERROR_RATE. I intentionally slowed down the POST request so you can see how the loading state works. Feel free to change how long the delay is (it's in milliseconds). I also wanted you to see what errors look like, so it fails 20% of the time, this is also configurable.\n\nOkay, let's build a UI that shows users deep thoughts, and allow them to post their own. In App.jsx, put\n\n```javascript\nimport { useEffect, useState } from \"react\";\n\nexport default function App() {\n  const [thoughts, setThoughts] = useState([]);\n  const [thought, setThought] = useState(\"\");\n\n  async function postDeepThought() {\n    setThought(\"\");\n    const response = await fetch(\"/thoughts\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ thought }),\n    });\n    if (!response.ok) {\n      alert(\"This thought was not deep enough. Please try again.\");\n      return;\n    }\n    const { thoughts: newThoughts } = await response.json();\n    setThoughts(newThoughts);\n  }\n\n  useEffect(() =\u003e {\n    fetch(\"/thoughts\")\n      .then((res) =\u003e res.json())\n      .then((data) =\u003e {\n        setThoughts(data);\n      });\n  }, []);\n\n  return (\n    \u003cdiv className=\"app\"\u003e\n      \u003ch1\u003eDeep Thoughts\u003c/h1\u003e\n      \u003cform\n        onSubmit={(e) =\u003e {\n          e.preventDefault();\n          postDeepThought();\n        }}\n      \u003e\n        \u003clabel htmlFor=\"thought\"\u003eWhat's on your mind?\u003c/label\u003e\n        \u003ctextarea\n          id=\"thought\"\n          name=\"thought\"\n          rows=\"5\"\n          cols=\"33\"\n          value={thought}\n          onChange={(e) =\u003e setThought(e.target.value)}\n        /\u003e\n        \u003cbutton type=\"submit\"\u003eSubmit\u003c/button\u003e\n      \u003c/form\u003e\n      \u003cul\u003e\n        {thoughts.map((thought, index) =\u003e (\n          \u003cli key={thought}\u003e{thought}\u003c/li\u003e\n        ))}\n      \u003c/ul\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n- Nothing surprising here. We get thoughts on load, and we reload them on POST\n- The big issue here is that the user is shown no feedback while the POST happening.\n- We could just append to thoughts and hope for the best - and this is what we used to do.\n- However we can use `useOptimistic` and get a lot of the error cases and other problems wrapped up and taken care of for us.\n\n[starter]: https://github.com/btholt/irv6-project/tree/main/starter/optimistic\n[completed]: https://github.com/btholt/irv6-project/tree/main/completed/optimistic\n","slug":"the-project","title":"The Project","section":"Optimistic Values","icon":"sun","filePath":"/home/runner/work/intermediate-react-v6/intermediate-react-v6/lessons/07-optimistic-values/B-the-project.md","nextSlug":"/lessons/optimistic-values/useOptimistic-Hook","prevSlug":"/lessons/optimistic-values/what-are-optimistic-values"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"optimistic-values","slug":"the-project"},"buildId":"81bftuYLGkwiC8AXLtnRs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>